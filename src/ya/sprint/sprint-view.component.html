<div class=global-container>

  <div class="positioner">
    <input type="file" accept="image/*" #file style="display:none" (change)="uploadBackground($event)">

    <md-card class="sprint-card">
      <div class="sprint-title">
        <h3>{{sprint?.name}}</h3>
      </div>

      <div class="scrum-master">
          <h4>@{{scrummaster?.name}}</h4>
      </div>

      <div class="sprint-menu">
        <button md-icon-button (click)="editSprint(sprint)"><md-icon>edit</md-icon></button>

        <button md-icon-button [mdMenuTriggerFor]="menu">
          <md-icon>more_vert</md-icon>
        </button>
        <md-menu #menu="mdMenu">
          <button md-menu-item (click)="editSprint(sprint)">
            <md-icon>edit</md-icon>
            <span>Edit</span>
          </button>
          <button md-menu-item (click)="file.click()">
              <md-icon>image</md-icon>
              <span>Change Background</span>
          </button>
          <button md-menu-item disabled>
            <md-icon>delete</md-icon>
            <span>Delete</span>
          </button>
        </md-menu>
      </div>

      <div class="image-container">
        <div class="image-overlay">

          <div class="metrics">

            <div class="metric metric-border">
              <span class="value">3</span>
              <br>
              <span class="legend">Day</span>
            </div>

            <div class="metric metric-border">
              <span class="value">{{progressAsPercentage() | number:'1.0-0' }}%</span>
              <br>
              <span class="legend">Progress</span>
            </div>

            <div class="metric metric-border">
              <span class="value">{{stories?.length}}</span>
              <br>
              <span class="legend">story</span>
            </div>

            <div class="metric metric-border">
              <span class="value">{{sprint?.estimate}}</span>
              <br>
              <span class="legend">estimate</span>
            </div>

            <div class="metric">
              <span class="value">{{sprint?.velocity}}</span>
              <br>
              <span class="legend">velocity</span>
            </div>

          </div>



        </div>
        <img *ngIf="sprint?.background" md-card-image [src]="sprint?.background">
      </div>
      <md-progress-bar [mode]="'determinate'" [value]="progressAsPercentage()"></md-progress-bar>
      <md-card-actions>
        <button md-button (click)="startNewDailyMeeting()" [disabled]="!(stories?.length > 0)" color="accent"><md-icon>today</md-icon> START DAILY MEETING</button>
        <button md-button (click)="addStory()" color="accent"> ADD STORY</button>
      </md-card-actions>
    </md-card>

    <section-title>Burndown Chart:
      <section-title-highlight>{{(sprint)?.meetingNumber}} days</section-title-highlight>
    </section-title>

    <div fxLayout fxLayoutWrap="wrap" fxLayoutAlign="start start">
      <div class="flex-item" fxFlex="5%">
      </div>
      <div class="flex-item" fxFlex="90%">
        <sprint-burndown [stories]="stories" [sprint]="sprint"></sprint-burndown>
      </div>
      <div class="flex-item" fxFlex="5%">
      </div>
    </div>


    <section-title>Sprint Backlog:
      <section-title-highlight>{{ stories?.length }} stories</section-title-highlight>
    </section-title>

    <sprint-story-grid [stories]="stories" (onAdd)="addStory()"></sprint-story-grid>

    <section-title>
      <section-title-highlight>{{ progressHistory?.length }}</section-title-highlight> Days Schedule</section-title>
    <sprint-progress-schedule [progressHistory]="progressHistory"></sprint-progress-schedule>
  </div>

</div>